<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ëŸ¬ë¸Œì¹´ ë¼ì´ë¸Œ ì„±ê³µ ê³„ì‚°ê¸°</title>
    <style>
      :root {
        --primary: #ff527b;
        --bg: #fff5f7;
        --card-bg: #ffffff;
        --border: #ffbdd0;

        /* ìƒ‰ìƒë³„ ì„ ì–¸ */
        --c-pink: #ff3366;
        --c-red: #ff3333;
        --c-yellow: #ffcc00;
        --c-green: #00cc66;
        --c-blue: #0099ff;
        --c-purple: #9933cc;
        --c-all: linear-gradient(
          90deg,
          #ff3333,
          #ffcc00,
          #00cc66,
          #0099ff,
          #9933cc
        );
        --c-none: #999;
      }
      body {
        font-family: "Pretendard", "Apple SD Gothic Neo", "Meiryo", "Yu Gothic",
          sans-serif;
        background-color: var(--bg);
        color: #333;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
      }
      .container {
        background-color: var(--card-bg);
        width: 100%;
        max-width: 650px;
        padding: 25px;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(255, 82, 123, 0.15);
        border: 2px solid var(--border);
        position: relative;
      }

      /* ì–¸ì–´ ìŠ¤ìœ„ì¹˜ ìŠ¤íƒ€ì¼ */
      .lang-switch {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        gap: 5px;
      }
      .lang-btn {
        border: 1px solid var(--primary);
        background: white;
        color: var(--primary);
        padding: 5px 10px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.8rem;
        font-weight: bold;
        transition: all 0.2s;
      }
      .lang-btn.active {
        background: var(--primary);
        color: white;
      }

      h1 {
        color: var(--primary);
        text-align: center;
        font-size: 1.6rem;
        margin-bottom: 20px;
        margin-top: 10px;
        line-height: 1.4;
      }
      h2 {
        font-size: 1.1rem;
        color: #444;
        border-left: 5px solid var(--primary);
        padding-left: 10px;
        margin-top: 30px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .input-group {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin-bottom: 10px;
      }
      @media (max-width: 500px) {
        .input-group {
          grid-template-columns: repeat(
            2,
            1fr
          ); /* ë²„íŠ¼ ì¶”ê°€ë¡œ ê³µê°„ í™•ë³´ë¥¼ ìœ„í•´ 2ì—´ë¡œ ë³€ê²½ */
        }
        .lang-switch {
          position: static;
          justify-content: flex-end;
          margin-bottom: 10px;
        }
      }

      .input-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        background: #fff;
        padding: 8px 5px;
        border-radius: 8px;
        border: 1px solid #f0f0f0;
      }
      .input-item label {
        font-size: 0.8rem;
        margin-bottom: 6px;
        font-weight: bold;
        white-space: nowrap;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      /* ìŠ¤í…Œí¼(ë²„íŠ¼+ì¸í’‹) ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
      .stepper-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
        width: 100%;
      }

      /* ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
      .input-item input {
        width: 40px; /* ë²„íŠ¼ ë•Œë¬¸ì— ë„ˆë¹„ ì¡°ê¸ˆ ì¤„ì„ */
        padding: 5px;
        text-align: center;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 1rem;
        outline: none;
        transition: border 0.2s;
        /* ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸° */
        -moz-appearance: textfield;
      }
      .input-item input::-webkit-outer-spin-button,
      .input-item input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      .input-item input:focus {
        border-color: var(--primary);
        background-color: #fffbfd;
      }

      /* ì¦ê° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
      .step-btn {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 1px solid #ffbdd0;
        background-color: white;
        color: var(--primary);
        font-weight: bold;
        font-size: 1.1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        user-select: none;
        transition: background-color 0.1s;
        padding: 0;
        line-height: 1;
      }
      .step-btn:active {
        background-color: #ffe0e9;
      }
      .step-btn:hover {
        border-color: var(--primary);
      }

      /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
      .section-deck {
        background-color: #fffcf0;
        padding: 15px;
        border-radius: 12px;
        border: 1px solid #ffecb3;
      }
      .section-existing {
        background-color: #f0f9ff;
        padding: 15px;
        border-radius: 12px;
        border: 1px solid #cceeff;
        margin-top: 20px;
      }

      /* 4ë²ˆ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
      .section-burn {
        background-color: #f5f5f5;
        padding: 20px;
        border-radius: 12px;
        border: 1px solid #ddd;
        text-align: center;
      }

      /* ì•„ì´ì½˜/í…ìŠ¤íŠ¸ ìƒ‰ìƒ í´ë˜ìŠ¤ */
      .txt-pink {
        color: var(--c-pink);
      }
      .txt-red {
        color: var(--c-red);
      }
      .txt-yellow {
        color: var(--c-yellow);
      }
      .txt-green {
        color: var(--c-green);
      }
      .txt-blue {
        color: var(--c-blue);
      }
      .txt-purple {
        color: var(--c-purple);
      }
      .txt-all {
        background: var(--c-all);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 900;
        display: inline-block;
      }
      .heart-icon {
        font-size: 1.1rem;
        line-height: 1;
      }
      .txt-none {
        color: var(--c-none);
      }

      .draw-section {
        background-color: #fff0f5;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        margin-top: 20px;
        border: 1px dashed var(--primary);
      }

      .big-input {
        width: 60px !important;
        padding: 10px;
        font-size: 1.4rem !important;
        text-align: center;
        border: 2px solid #ccc;
        border-radius: 8px;
        margin-left: 0;
        font-weight: bold;
      }
      .draw-section input.big-input {
        border-color: var(--primary);
        color: var(--primary);
      }

      .btn-calc {
        width: 100%;
        background: linear-gradient(135deg, #ff527b, #ff8ba7);
        color: white;
        border: none;
        padding: 18px;
        font-size: 1.2rem;
        font-weight: bold;
        border-radius: 15px;
        cursor: pointer;
        margin-top: 25px;
        box-shadow: 0 4px 15px rgba(255, 82, 123, 0.3);
        transition: transform 0.1s;
      }
      .btn-calc:active {
        transform: scale(0.98);
      }

      .result-box {
        margin-top: 10px;
        margin-bottom: 30px;
        text-align: center;
        padding: 20px;
        background-color: #fff;
        border-radius: 15px;
        border: 3px solid var(--primary);
      }
      .result-percent {
        font-size: 3rem;
        font-weight: 800;
        color: var(--primary);
        margin: 10px 0;
        line-height: 1;
      }

      .sample-box {
        margin-top: 15px;
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        text-align: left;
        font-size: 0.9rem;
        border: 1px solid #ddd;
      }
      .sample-title {
        font-weight: bold;
        margin-bottom: 8px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
        color: #555;
      }
      .sample-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 5px;
      }
      .sample-item {
        background: white;
        padding: 5px;
        border-radius: 5px;
        text-align: center;
        border: 1px solid #eee;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="lang-switch">
        <button class="lang-btn active" id="btn-ko" onclick="setLanguage('ko')">
          ğŸ‡°ğŸ‡· í•œêµ­ì–´
        </button>
        <button class="lang-btn" id="btn-ja" onclick="setLanguage('ja')">
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª
        </button>
      </div>

      <h1 data-i18n="title">ğŸ¤ ëŸ¬ë¸Œì¹´ ë¼ì´ë¸Œ ì„±ê³µ ê³„ì‚°ê¸°</h1>

      <div class="result-box" id="top-result-box">
        <div style="font-size: 0.9rem; color: #666" data-i18n="res_title">
          ë¼ì´ë¸Œ ì„±ê³µ í™•ë¥  (50,000íšŒ ì‹œë®¬ë ˆì´ì…˜)
        </div>
        <div class="result-percent" id="result-text">- %</div>

        <div class="sample-box" id="sample-result-box" style="display: none">
          <div class="sample-title" data-i18n="sample_title">
            ğŸ² ëœë¤ 1íšŒ ì²´í¬ ê²°ê³¼ (ì‹¤ì œë¡œ ë½‘ì€ ì¹´ë“œ)
          </div>
          <div id="sample-content" class="sample-grid"></div>
          <div
            style="margin-top: 10px; text-align: right; font-weight: bold"
            id="sample-success-status"
          ></div>
          <div
            style="
              margin-top: 5px;
              text-align: right;
              font-size: 0.8rem;
              color: #888;
            "
            id="sample-burn-info"
          ></div>
        </div>
      </div>

      <div class="section-deck">
        <h2>
          <span data-i18n="sec1_title">1. í˜„ì¬ ë±ì— ë‚¨ì€ ì¹´ë“œ</span>
          <span
            >(<span data-i18n="total">Total</span>:
            <span id="total-deck-count">0</span>)</span
          >
        </h2>
        <div class="input-group">
          <div class="input-item">
            <label class="txt-pink"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_pink">ë¶„í™</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-pink', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-pink"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-pink', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-red"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_red">ë¹¨ê°•</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-red', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-red"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-red', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-yellow"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_yellow">ë…¸ë‘</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-yellow', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-yellow"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-yellow', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-green"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_green">ì´ˆë¡</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-green', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-green"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-green', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-blue"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_blue">íŒŒë‘</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-blue', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-blue"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-blue', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-purple"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_purple">ë³´ë¼</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-purple', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-purple"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-purple', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-all"><span class="heart-icon">â™¥</span> ALL</label>
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-all', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-all"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-all', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-none"
              >ğŸ’£ <span data-i18n="c_none">í•˜íŠ¸ì—†ìŒ</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('d-none', -1)">
                -
              </button>
              <input
                type="number"
                class="deck-in"
                id="d-none"
                value="0"
                min="0"
              />
              <button class="step-btn" onclick="updateVal('d-none', 1)">
                +
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="section-existing">
        <h2>
          <span data-i18n="sec2_title">2. ì´ë¯¸ ê°€ì§€ê³  ìˆëŠ” í•˜íŠ¸</span>
          <span>(<span data-i18n="field">í•„ë“œ</span>)</span>
        </h2>
        <div class="input-group">
          <div class="input-item">
            <label class="txt-pink"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_pink">ë¶„í™</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-pink', -1)">
                -
              </button>
              <input type="number" id="e-pink" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-pink', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-red"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_red">ë¹¨ê°•</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-red', -1)">
                -
              </button>
              <input type="number" id="e-red" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-red', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-yellow"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_yellow">ë…¸ë‘</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-yellow', -1)">
                -
              </button>
              <input type="number" id="e-yellow" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-yellow', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-green"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_green">ì´ˆë¡</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-green', -1)">
                -
              </button>
              <input type="number" id="e-green" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-green', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-blue"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_blue">íŒŒë‘</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-blue', -1)">
                -
              </button>
              <input type="number" id="e-blue" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-blue', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-purple"
              ><span class="heart-icon">â™¥</span>
              <span data-i18n="c_purple">ë³´ë¼</span></label
            >
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-purple', -1)">
                -
              </button>
              <input type="number" id="e-purple" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-purple', 1)">
                +
              </button>
            </div>
          </div>
          <div class="input-item">
            <label class="txt-all"><span class="heart-icon">â™¥</span> ALL</label>
            <div class="stepper-wrapper">
              <button class="step-btn" onclick="updateVal('e-all', -1)">
                -
              </button>
              <input type="number" id="e-all" value="0" min="0" />
              <button class="step-btn" onclick="updateVal('e-all', 1)">
                +
              </button>
            </div>
          </div>
        </div>
      </div>

      <h2><span data-i18n="sec3_title">3. ë¼ì´ë¸Œ ì„±ê³µ ì¡°ê±´ (ëª©í‘œ)</span></h2>
      <div class="input-group">
        <div class="input-item">
          <label class="txt-pink"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_pink">ë¶„í™</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-pink', -1)">
              -
            </button>
            <input type="number" id="r-pink" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-pink', 1)">+</button>
          </div>
        </div>
        <div class="input-item">
          <label class="txt-red"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_red">ë¹¨ê°•</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-red', -1)">-</button>
            <input type="number" id="r-red" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-red', 1)">+</button>
          </div>
        </div>
        <div class="input-item">
          <label class="txt-yellow"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_yellow">ë…¸ë‘</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-yellow', -1)">
              -
            </button>
            <input type="number" id="r-yellow" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-yellow', 1)">
              +
            </button>
          </div>
        </div>
        <div class="input-item">
          <label class="txt-green"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_green">ì´ˆë¡</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-green', -1)">
              -
            </button>
            <input type="number" id="r-green" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-green', 1)">
              +
            </button>
          </div>
        </div>
        <div class="input-item">
          <label class="txt-blue"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_blue">íŒŒë‘</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-blue', -1)">
              -
            </button>
            <input type="number" id="r-blue" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-blue', 1)">+</button>
          </div>
        </div>
        <div class="input-item">
          <label class="txt-purple"
            ><span class="heart-icon">â™¥</span>
            <span data-i18n="c_purple">ë³´ë¼</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-purple', -1)">
              -
            </button>
            <input type="number" id="r-purple" value="0" min="0" />
            <button class="step-btn" onclick="updateVal('r-purple', 1)">
              +
            </button>
          </div>
        </div>
        <div class="input-item" style="grid-column: span 2; width: 100%">
          <label class="txt-none" style="color: #333"
            >ğŸ¤ <span data-i18n="c_any">ë¬´ìƒ‰í•˜íŠ¸</span></label
          >
          <div class="stepper-wrapper">
            <button class="step-btn" onclick="updateVal('r-any', -1)">-</button>
            <input
              type="number"
              id="r-any"
              value="0"
              min="0"
              style="width: 50%"
            />
            <button class="step-btn" onclick="updateVal('r-any', 1)">+</button>
          </div>
        </div>
      </div>

      <div class="section-burn" style="margin-top: 25px">
        <label
          for="burn-count"
          style="
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
          "
        >
          <span data-i18n="sec4_title">4. ë‚¼ ë¼ì´ë¸Œ ì¹´ë“œ ìˆ˜ (0~3ì¥)</span>
        </label>
        <div
          style="
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
          "
        >
          <span style="font-size: 1.5rem">ğŸ—‘ï¸</span>
          <div class="stepper-wrapper" style="width: auto">
            <button class="step-btn" onclick="updateVal('burn-count', -1)">
              -
            </button>
            <input
              type="number"
              class="big-input"
              id="burn-count"
              value="0"
              min="0"
              max="3"
            />
            <button class="step-btn" onclick="updateVal('burn-count', 1)">
              +
            </button>
          </div>
        </div>
        <div style="margin-top: 5px; font-size: 0.8rem; color: #777">
          <span data-i18n="sec4_desc"
            >ì´ ìˆ˜ë§Œí¼ ë±ì—ì„œ ëœë¤ìœ¼ë¡œ ì¹´ë“œê°€ ì œê±°ë©ë‹ˆë‹¤.</span
          >
        </div>
      </div>

      <div class="draw-section">
        <label
          for="draw-count"
          style="display: block; margin-bottom: 10px; font-weight: bold"
        >
          <span data-i18n="sec5_title">5. ëª‡ ì¥ ì²´í¬í• ê¹Œìš”?</span>
        </label>
        <div
          style="
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
          "
        >
          <span style="font-size: 2rem">ğŸ´</span>
          <div class="stepper-wrapper" style="width: auto">
            <button class="step-btn" onclick="updateVal('draw-count', -1)">
              -
            </button>
            <input
              type="number"
              class="big-input"
              id="draw-count"
              value="1"
              min="1"
            />
            <button class="step-btn" onclick="updateVal('draw-count', 1)">
              +
            </button>
          </div>
        </div>
        <div style="margin-top: 5px; font-size: 0.8rem; color: #666">
          (<span data-i18n="sec5_desc"
            >ì†Œëª¨ëœ ì¹´ë“œë¥¼ ì œì™¸í•œ ë±ì—ì„œ ë½‘ìŠµë‹ˆë‹¤</span
          >)
        </div>
      </div>

      <button class="btn-calc" onclick="runSimulation()" data-i18n="btn_calc">
        ì²´í¬ ë° í™•ë¥  ê³„ì‚°
      </button>
    </div>

    <script>
      // --- ê°’ ë³€ê²½ í—¬í¼ í•¨ìˆ˜ (ë²„íŠ¼ìš©) ---
      function updateVal(id, delta) {
        const input = document.getElementById(id);
        let currentVal = parseInt(input.value) || 0;
        let min = parseInt(input.getAttribute("min")) || 0;
        let max = input.hasAttribute("max")
          ? parseInt(input.getAttribute("max"))
          : 999;

        let newVal = currentVal + delta;
        if (newVal < min) newVal = min;
        if (newVal > max) newVal = max;

        input.value = newVal;
        // ì…ë ¥ê°’ì´ ë°”ë€Œì—ˆìŒì„ ì•Œë¦¼ (Total ê°±ì‹  ë“±ì„ ìœ„í•´)
        input.dispatchEvent(new Event("input"));
      }

      // --- ë‹¤êµ­ì–´ ì²˜ë¦¬ ë¡œì§ ---
      let currentLang = "ko"; // ê¸°ë³¸ ì–¸ì–´

      const translations = {
        ko: {
          title: "ğŸ¤ ëŸ¬ë¸Œì¹´ ë¼ì´ë¸Œ ì„±ê³µ ê³„ì‚°ê¸°",
          sec1_title: "1. í˜„ì¬ ë±ì— ë‚¨ì€ ì¹´ë“œ",
          total: "Total",
          sec2_title: "2. ì´ë¯¸ ê°€ì§€ê³  ìˆëŠ” í•˜íŠ¸",
          field: "í•„ë“œ",
          sec3_title: "3. ë¼ì´ë¸Œ ì„±ê³µ ì¡°ê±´ (ëª©í‘œ)",
          sec4_title: "4. ë‚¼ ë¼ì´ë¸Œ ì¹´ë“œ ìˆ˜ (0~3ì¥)",
          sec4_desc: "ì´ ìˆ˜ë§Œí¼ ë±ì—ì„œ ëœë¤ìœ¼ë¡œ ì¹´ë“œê°€ ì œê±°ë©ë‹ˆë‹¤.",
          sec5_title: "5. ëª‡ ì¥ ì²´í¬í• ê¹Œìš”?",
          sec5_desc: "ì†Œëª¨ëœ ì¹´ë“œë¥¼ ì œì™¸í•œ ë±ì—ì„œ ë½‘ìŠµë‹ˆë‹¤",
          btn_calc: "ì²´í¬ ë° í™•ë¥  ê³„ì‚°",
          res_title: "ë¼ì´ë¸Œ ì„±ê³µ í™•ë¥  (50,000íšŒ ì‹œë®¬ë ˆì´ì…˜)",
          sample_title: "ğŸ² ëœë¤ 1íšŒ ì²´í¬ ê²°ê³¼ (ì‹¤ì œë¡œ ë½‘ì€ ì¹´ë“œ)",

          c_pink: "ë¶„í™",
          c_red: "ë¹¨ê°•",
          c_yellow: "ë…¸ë‘",
          c_green: "ì´ˆë¡",
          c_blue: "íŒŒë‘",
          c_purple: "ë³´ë¼",
          c_none: "í•˜íŠ¸ì—†ìŒ",
          c_any: "ë¬´ìƒ‰í•˜íŠ¸",

          // ë‚´ë¶€ ì‚¬ìš© í…ìŠ¤íŠ¸
          alert_min_draw: "ìµœì†Œ 1ì¥ì€ ì²´í¬í•´ì•¼ í•©ë‹ˆë‹¤.",
          alert_deck_short: "ë±ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (ë‚¨ì€ ë±: {0}ì¥ vs í•„ìš”: {1}ì¥)",
          res_success: "ğŸ‰ ë¼ì´ë¸Œ ì„±ê³µ!",
          res_fail: "ğŸ’€ ì‹¤íŒ¨...",
          burn_info: "â€» ì•ì„œ {0}ì¥ì€ ëœë¤ìœ¼ë¡œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.",
        },
        ja: {
          title: "ğŸ¤ ãƒ©ãƒ–ã‚«ãƒ©ã‚¤ãƒ–æˆåŠŸè¨ˆç®—æ©Ÿ",
          sec1_title: "1. ç¾åœ¨ã®å±±æœ­ï¼ˆãƒ‡ãƒƒã‚­ï¼‰",
          total: "åˆè¨ˆ",
          sec2_title: "2. ç²å¾—æ¸ˆã¿ãƒãƒ¼ãƒˆ",
          field: "ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰",
          sec3_title: "3. ãƒ©ã‚¤ãƒ–æˆåŠŸæ¡ä»¶ï¼ˆç›®æ¨™ï¼‰",
          sec4_title: "4. å‡ºã™ãƒ©ã‚¤ãƒ–ã‚«ãƒ¼ãƒ‰ã®æšæ•°ï¼ˆ0~3æšï¼‰",
          sec4_desc: "ã“ã®æšæ•°åˆ†ã€å±±æœ­ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é™¤å¤–ã•ã‚Œã¾ã™ã€‚",
          sec5_title: "5. ä½•æšã‚ãã‚Šã¾ã™ã‹ï¼Ÿ",
          sec5_desc: "é™¤å¤–ã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã‚’é™¤ã„ãŸå±±æœ­ã‹ã‚‰å¼•ãã¾ã™",
          btn_calc: "ç¢ºç‡ã‚’è¨ˆç®—ã™ã‚‹",
          res_title: "ãƒ©ã‚¤ãƒ–æˆåŠŸç¢ºç‡ (50,000å›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³)",
          sample_title: "ğŸ² ãƒ©ãƒ³ãƒ€ãƒ 1å›ãƒã‚§ãƒƒã‚¯çµæœ (å®Ÿéš›ã«å¼•ã„ãŸã‚«ãƒ¼ãƒ‰)",

          c_pink: "æ¡ƒ",
          c_red: "èµ¤",
          c_yellow: "é»„",
          c_green: "ç·‘",
          c_blue: "é’",
          c_purple: "ç´«",
          c_none: "ç„¡ã—",
          c_any: "ç„¡",

          // JS ë‚´ë¶€ ì‚¬ìš© í…ìŠ¤íŠ¸
          alert_min_draw: "æœ€ä½1æšã¯ãƒã‚§ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚",
          alert_deck_short: "å±±æœ­ãŒè¶³ã‚Šã¾ã›ã‚“ï¼ (æ®‹ã‚Š: {0}æš vs å¿…è¦: {1}æš)",
          res_success: "ğŸ‰ ãƒ©ã‚¤ãƒ–æˆåŠŸï¼",
          res_fail: "ğŸ’€ å¤±æ•—â€¦",
          burn_info: "â€» å…ˆã«{0}æšãŒãƒ©ãƒ³ãƒ€ãƒ ã«é™¤å¤–ã•ã‚Œã¾ã—ãŸã€‚",
        },
      };

      function setLanguage(lang) {
        currentLang = lang;

        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        document.getElementById("btn-ko").className =
          lang === "ko" ? "lang-btn active" : "lang-btn";
        document.getElementById("btn-ja").className =
          lang === "ja" ? "lang-btn active" : "lang-btn";

        // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ (data-i18n ì†ì„± ì‚¬ìš©)
        const elements = document.querySelectorAll("[data-i18n]");
        elements.forEach((el) => {
          const key = el.getAttribute("data-i18n");
          if (translations[lang][key]) {
            el.innerText = translations[lang][key];
          }
        });

        // ì´ë¯¸ ê³„ì‚°ëœ ê²°ê³¼ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ë Œë”ë§ (ì–¸ì–´ ë°˜ì˜ì„ ìœ„í•´)
        const resultText = document.getElementById("result-text").innerText;
        if (resultText !== "- %") {
          runSimulation();
        }
      }

      // --- ê¸°ë³¸ ë¡œì§ ---
      const allNumberInputs = document.querySelectorAll('input[type="number"]');
      allNumberInputs.forEach((input) => {
        input.addEventListener("change", validateInput);
        input.addEventListener("keyup", validateInput);
      });

      function validateInput() {
        if (this.value < 0) this.value = 0;
        if (
          this.hasAttribute("max") &&
          parseInt(this.value) > parseInt(this.getAttribute("max"))
        ) {
          this.value = this.getAttribute("max");
        }
      }

      const deckInputs = document.querySelectorAll(".deck-in");
      deckInputs.forEach((input) =>
        input.addEventListener("input", updateDeckTotal)
      );

      function updateDeckTotal() {
        let sum = 0;
        deckInputs.forEach((inp) => {
          let val = parseInt(inp.value);
          if (val < 0) val = 0;
          sum += val || 0;
        });
        document.getElementById("total-deck-count").innerText = sum;
      }

      function runSimulation() {
        const getVal = (id) =>
          Math.max(0, parseInt(document.getElementById(id).value) || 0);
        const t = translations[currentLang]; // í˜„ì¬ ì–¸ì–´ íŒ©

        const deck = {
          pink: getVal("d-pink"),
          red: getVal("d-red"),
          yellow: getVal("d-yellow"),
          green: getVal("d-green"),
          blue: getVal("d-blue"),
          purple: getVal("d-purple"),
          all: getVal("d-all"),
          none: getVal("d-none"),
        };
        const existing = {
          pink: getVal("e-pink"),
          red: getVal("e-red"),
          yellow: getVal("e-yellow"),
          green: getVal("e-green"),
          blue: getVal("e-blue"),
          purple: getVal("e-purple"),
          all: getVal("e-all"),
        };
        const req = {
          pink: getVal("r-pink"),
          red: getVal("r-red"),
          yellow: getVal("r-yellow"),
          green: getVal("r-green"),
          blue: getVal("r-blue"),
          purple: getVal("r-purple"),
          any: getVal("r-any"),
        };

        const burnCount = getVal("burn-count");
        const drawCount = getVal("draw-count");
        const totalDeckSize = Object.values(deck).reduce((a, b) => a + b, 0);

        if (drawCount <= 0) {
          alert(t.alert_min_draw);
          return;
        }
        if (totalDeckSize < burnCount + drawCount) {
          let msg = t.alert_deck_short
            .replace("{0}", totalDeckSize)
            .replace("{1}", burnCount + drawCount);
          alert(msg);
          return;
        }

        let deckArray = [];
        for (let k in deck) {
          for (let i = 0; i < deck[k]; i++) deckArray.push(k);
        }

        const SIMULATIONS = 50000;
        let successCount = 0;
        let lastDrawnSample = null;

        for (let i = 0; i < SIMULATIONS; i++) {
          let totalNeeded = burnCount + drawCount;
          let combinedPicks = partialShuffleAndDraw(
            [...deckArray],
            totalNeeded
          );
          let actualDrawn = combinedPicks.slice(burnCount);
          let isSuccess = checkSuccess(actualDrawn, existing, req);

          if (isSuccess) successCount++;

          if (i === 0) {
            lastDrawnSample = {
              drawn: actualDrawn,
              result: isSuccess,
              burnedCount: burnCount,
            };
          }
        }

        const percent = ((successCount / SIMULATIONS) * 100).toFixed(2);
        document.getElementById("result-text").innerText = percent + "%";

        displaySample(lastDrawnSample);

        // ê³„ì‚° í›„ ê²°ê³¼ë¥¼ ë³´ê¸° ìœ„í•´ ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
        document
          .querySelector(".container")
          .scrollIntoView({ behavior: "smooth" });
      }

      function displaySample(sampleData) {
        const t = translations[currentLang];
        const box = document.getElementById("sample-result-box");
        const content = document.getElementById("sample-content");
        const status = document.getElementById("sample-success-status");
        const burnInfo = document.getElementById("sample-burn-info");

        box.style.display = "block";
        content.innerHTML = "";

        let counts = {};
        sampleData.drawn.forEach((c) => {
          counts[c] = (counts[c] || 0) + 1;
        });

        // ìƒ‰ìƒ ì´ë¦„ ë§¤í•‘ (í˜„ì¬ ì–¸ì–´ ê¸°ì¤€)
        const labelMap = {
          pink: "â™¥ " + t.c_pink,
          red: "â™¥ " + t.c_red,
          yellow: "â™¥ " + t.c_yellow,
          green: "â™¥ " + t.c_green,
          blue: "â™¥ " + t.c_blue,
          purple: "â™¥ " + t.c_purple,
          all: "â™¥ ALL",
          none: "ğŸ’£ " + t.c_none,
        };
        const classMap = {
          pink: "txt-pink",
          red: "txt-red",
          yellow: "txt-yellow",
          green: "txt-green",
          blue: "txt-blue",
          purple: "txt-purple",
          all: "txt-all",
          none: "txt-none",
        };

        for (let key in counts) {
          let div = document.createElement("div");
          div.className = "sample-item";
          div.innerHTML = `<span class="${classMap[key]}" style="font-weight:bold;">${labelMap[key]}</span> : ${counts[key]}`;
          content.appendChild(div);
        }

        if (sampleData.result) {
          status.innerHTML = `<span style="color:var(--primary);">${t.res_success}</span>`;
        } else {
          status.innerHTML = `<span style="color:#666;">${t.res_fail}</span>`;
        }

        if (sampleData.burnedCount > 0) {
          burnInfo.innerText = t.burn_info.replace(
            "{0}",
            sampleData.burnedCount
          );
        } else {
          burnInfo.innerText = "";
        }
      }

      function partialShuffleAndDraw(arr, n) {
        let result = [];
        let len = arr.length;
        for (let i = 0; i < n; i++) {
          let r = Math.floor(Math.random() * (len - i)) + i;
          let temp = arr[i];
          arr[i] = arr[r];
          arr[r] = temp;
          result.push(arr[i]);
        }
        return result;
      }

      function checkSuccess(drawnCards, existing, req) {
        let total = { ...existing };
        drawnCards.forEach((c) => {
          if (total[c] !== undefined) total[c]++;
          else if (c === "all") total.all = (total.all || 0) + 1;
        });

        let availableAll = total.all;
        let surplusColors = 0;

        const colors = ["pink", "red", "yellow", "green", "blue", "purple"];

        for (let c of colors) {
          let needed = req[c];
          let has = total[c];

          if (has >= needed) {
            surplusColors += has - needed;
          } else {
            let deficit = needed - has;
            if (availableAll >= deficit) {
              availableAll -= deficit;
            } else {
              return false;
            }
          }
        }

        if (surplusColors + availableAll >= req.any) {
          return true;
        }

        return false;
      }
    </script>
  </body>
</html>
